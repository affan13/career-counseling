<!DOCTYPE <!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" href="./styles/fonts.googleapis.css" />
    <link rel="stylesheet" href="./styles/bootstrap.min.css" />
    <link rel="stylesheet" href="./styles/custom.css" />

    <script src="./scripts/jquery.min.js"></script>
    <script src="./scripts/bootstrap.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/5.5.6/firebase.js"></script>
    <script src="./scripts/init-firebase.js"></script>
  </head>

  <body>
    <h1>Universities</h1>
    <div id="universities"></div>

    <script src="allFields.js"></script>
    <script>
      function universityDIV(key, value) {
        return `<div class="uni-box">
                <h6>${value.name}</h6>
                <p>
                  ${value.address} <strong>${value.city}</strong>
                </p>
                <p>${value.phone}</p>
                <a href="${
                  value.web
                }" target="_blank" rel="noopener noreferrer">Website</a>
                <div>
                  ${
                    value.fields
                      ? value.fields.map(function(v) {
                          return `<span>${v.name} (${v.percentage})</span>`;
                        })
                      : ""
                  }
                </div>
              </div>`;
      }

      firebase
        .database()
        .ref("universities")
        .once("value", function(param) {
          var universities = param.val();
          var universitiesDIV = document.getElementById("universities");
          Object.keys(universities).forEach(function(key) {
            var uni = universities[key];
            universitiesDIV.innerHTML += universityDIV(key, uni);
            uni.fields &&
              uni.fields.forEach(function(v) {
                console.log(v);
              });
          });
          if (universities === null) {
            alert("No universities in database.");
          }
        });
    </script>
    <script src="./scripts/nav-bar.js"></script>
  </body>
</html>
